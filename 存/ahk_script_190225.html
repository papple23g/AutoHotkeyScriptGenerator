<!DOCTYPE html>
<html>
<head>
    <script src="lib\brython.js"></script>
    <script src="lib\brython_stdlib.js"></script>
    <style>
    </style>
</head>

<body onload="brython(1)">

<script type="text/python">
from browser import doc,alert,bind,timer,window
from browser.html import *

#設置全域變數:AHK自定義函數字典
FUNCTION_DICT={
"AutoInput":
"""AutoInput(InputStr){
    clipboard_save = %ClipboardAll%
    Sleep 100
    clipboard = %InputStr%
    Send ^v
    clipboard = %clipboard_save%
}
""",
"WebSite_Clipboard":
"""WebSite_Clipboard(UrlA,UrlB){
    Send ^{c}
    Sleep 500
    Copy= % UriEncode(Clipboard)
    Run %UrlA%%Copy%%UrlB%
    return
}
""",
"UriEncode":
"""
;讓關鍵字轉化為網址解碼形式，得以讓關鍵字正確被搜尋
;參考自https://rosettacode.org/wiki/URL_encoding#AutoHotkey
UriEncode(Uri){
    VarSetCapacity(Var, StrPut(Uri, "UTF-8"), 0)
    StrPut(Uri, &Var, "UTF-8")
    f := A_FormatInteger
    SetFormat, IntegerFast, H
    While Code := NumGet(Var, A_Index - 1, "UChar")
        If (Code >= 0x30 && Code <= 0x39 ; 0-9
            || Code >= 0x41 && Code <= 0x5A ; A-Z
            || Code >= 0x61 && Code <= 0x7A) ; a-z
            Res .= Chr(Code)
        Else
            Res .= "%" . SubStr(Code + 0x100, -1)
    SetFormat, IntegerFast, %f%
    Return, Res
}

""",
}

#設置樣式全域變數
ACTIVE_SCRIPT_TAG_COLOR="#ddd"
UNACTIVE_SCRIPT_TAG_COLOR="#bbb"

#定義動作函數:複製文字到剪貼簿
def CopyTextToClipborad(string):
    textarea_elt_forCopyText=TEXTAREA()
    textarea_elt_forCopyText.text=string
    doc<=textarea_elt_forCopyText
    textarea_elt_forCopyText.select()
    doc.execCommand("copy")
    textarea_elt_forCopyText.remove()

#定義功能函數:增加CSS樣式字串
def AppStyle(style_str):
    style_elt=doc.select("head style")[0]
    style_elt.text+=style_str

#定義含文字勾選元素A_INPUTCheckbox，點擊文字也可進行勾選
def A_INPUTCheckbox(item_name,checked=False,attr_dict=None):
    #定義SPAN文字被勾選時動作:勾選前方的checkbox
    def do_ckecking(ev):
        if ev.target.tagName!="INPUT":
            input_ckeckbox_elt=ev.currentTarget.select("input")[0]
            input_ckeckbox_elt.click()
    #設置inputCheckbox勾選元素
    inputCheckbox_elt=INPUT(type="checkbox",checked=checked)
    if attr_dict:
        for k,v in attr_dict.items():
            setattr(inputCheckbox_elt,k,v)
    return SPAN(inputCheckbox_elt+SPAN(item_name),Class="pointerCursor_onhover").bind('click',do_ckecking)
#設定DIV設定組合鍵功能區塊樣式
AppStyle("""
    .pointerCursor_onhover:hover *{
        cursor:pointer;
    }""")

#定義含文字勾選元素A_INPUTCheckbox，點擊文字也可進行勾選
def A_INPUTRadio(item_name,checked=False,name="",value=""):
    #定義SPAN文字被勾選時動作:選擇前方的Radio
    def do_ckecking(ev):
        if ev.target.tagName!="INPUT":
            input_ckeckbox_elt=ev.currentTarget.select("input")[0]
            input_ckeckbox_elt.click()
    inputRadio_elt=INPUT(type="radio",checked=checked,name=name,value=value)
    return SPAN(inputRadio_elt+SPAN(item_name),Class="pointerCursor_onhover").bind('click',do_ckecking)
"""
#定義含文字選擇元素A_INPUTRadio，點擊文字也可進行勾選
def A_INPUTRadio(item_name,checked=False,name="",value=""):
    #定義SPAN文字被勾選時動作:選擇前方的Radio
    def do_ckecking(ev):
        if ev.target.tagName!="INPUT":
            input_ckeckbox_elt=ev.currentTarget.select("input")[0]
            input_ckeckbox_elt.click()
    #設置A超連結元素的style設定:改成一般文字的樣子
    a_link_to_normalText_style_dict={"text-decoration":"none","color":"black"}
    #設置inputCheckbox勾選元素
    inputRadio_elt=INPUT(type="radio",checked=checked,name=name,value=value)
    return A(inputRadio_elt+SPAN(item_name),href="#!",style=a_link_to_normalText_style_dict).bind('click',do_ckecking)
"""

#定義DIV設定組合鍵區塊元素
def DIV_input_key_area():
    div_elt=DIV(id="div_input_key_area")
    #輸出勾選功能鍵
    div_elt<=A_INPUTCheckbox("Ctrl",attr_dict={"symbol":"^"})+SPAN(" ")
    div_elt<=A_INPUTCheckbox("Shift",attr_dict={"symbol":"+"})+SPAN(" ")
    div_elt<=A_INPUTCheckbox("Alt",attr_dict={"symbol":"!"})+SPAN(" ")
    div_elt<=A_INPUTCheckbox("Win",attr_dict={"symbol":"#"})+SPAN(" ")
    #輸出加上「+」符號
    div_elt<=SPAN("+ ")
    #定義SELECT選擇熱鍵元素
    def SELECT_hotkey():
        select_hotkey=SELECT(Class="normal_key")
        #輸出A到Z選項
        for i in range(ord("A"),ord("Z")+1):
            select_hotkey<=OPTION(chr(i),value=chr(i))
        #輸出特殊按鍵選項
        for key in ["Enter","Space","Tab","CapsLock"]:
            select_hotkey<=OPTION(key,value=key)
        #輸出數字鍵(上排和右側)按鍵選項
        for key in [str(i) for i in range(10)]+["Numpad"+str(i) for i in range(10)]:
            select_hotkey<=OPTION(key,value=key)
        #輸出F1至F24按鍵選項
        for key in ["F"+str(i) for i in range(1,25)]:
            select_hotkey<=OPTION(key,value=key)
        return select_hotkey
    div_elt<=SELECT_hotkey()
    return div_elt


#定義DIV設定執行功能區塊
def DIV_function():
    #設置準輸出DIV元素
    div_elt=DIV(id="DIV_function")
    
    ##2#定義DIV功能子選項(路徑、方式、對象等)區塊
    def DIV_func_conent(func_name):
        div_elt=DIV(id="DIV_func_conent")
        if func_name=="開啟檔案":
            div_elt<=SPAN("檔案路徑: ")
            div_elt<=INPUT(type="text",size="30")+BR()
            #定義勾取"使用程式開啟"時的動作:開放文字欄輸入
            def checkbox_onClick(ev):
                inputCheckbox_elt=ev.currentTarget
                input_elt=inputCheckbox_elt.parent.parent.select('input[type="text"]')[1]
                input_elt.disabled=(not inputCheckbox_elt.checked)
            a_inputCheckbox_elt=A_INPUTCheckbox("使用程式開啟(路徑):")
            a_inputCheckbox_elt.select("input")[0].bind("click",checkbox_onClick)
            div_elt<=a_inputCheckbox_elt
            div_elt<=INPUT(type="text",size="30",disabled=True)
        elif func_name=="開啟資料夾":
            div_elt<=SPAN("資料夾路徑: ")+INPUT(type="text",size="30")
        elif func_name=="開啟網頁":
            div_elt<=SPAN("網址: ")
            div_elt<=INPUT(type="text",size="30")
        elif func_name=="搜尋選取的關鍵字":##待追加
            select_elt=SELECT(style={"margin-top":"10px"})
            select_elt<=OPTION("Google搜尋")
            select_elt<=OPTION("Youtube搜尋")
            select_elt<=OPTION("自訂...")
            div_elt<=select_elt+BR()
            div_elt<=SPAN("關鍵字之前的網址: ")
            input_elt_A=INPUT(value="https://www.google.com.tw/search?q=",type="text",size="40",disabled=True)
            div_elt<=input_elt_A+BR()
            div_elt<=SPAN("關鍵字之後的網址: ")
            input_elt_B=INPUT(value="",type="text",size="40",disabled=True)
            div_elt<=input_elt_B

            #定義動作:更換INPUT關鍵字前後網址
            def change_input(ev):
                select_elt=ev.currentTarget
                input_elt_A.disabled=True
                input_elt_B.disabled=True
                if select_elt.value=="自訂...":
                    input_elt_A.value=""
                    input_elt_A.disabled=False
                    input_elt_B.value=""
                    input_elt_B.disabled=False
                if select_elt.value=="Google搜尋":
                    input_elt_A.value="https://www.google.com.tw/search?q="
                    input_elt_B.value=""
                elif select_elt.value=="Youtube搜尋":
                    input_elt_A.value="https://www.youtube.com/results?search_query="
                    input_elt_B.value=""


            select_elt.bind("change",change_input)
        elif func_name=="執行程式":
            select_elt=SELECT()
            select_elt<=OPTION("程式路徑 ")
            select_elt<=OPTION("記事本")
            select_elt<=OPTION("小算盤")
            select_elt<=OPTION("小畫家")
            select_elt<=OPTION("剪取工具")
            select_elt<=OPTION("命令提示字元")
            #定義動作:更換INPUT程式路徑
            def change_input(ev):
                select_elt=ev.currentTarget
                input_elt=select_elt.nextSibling
                input_elt.remove()
                div_elt=select_elt.parent
                if select_elt.value=="程式路徑":
                        input_elt=INPUT(type="text",size="30")
                elif select_elt.value=="記事本":
                        input_elt=INPUT(value="Notepad.exe",disabled=True,type="text",size="30")
                elif select_elt.value=="小算盤":
                        input_elt=INPUT(value="%windir%\system32\calc.exe",disabled=True,type="text",size="30")
                elif select_elt.value=="小畫家":
                        input_elt=INPUT(value="%windir%\system32\mspaint.exe",disabled=True,type="text",size="30")
                elif select_elt.value=="自黏便箋":
                        input_elt=INPUT(value="StikyNot.exe",disabled=True,type="text",size="30")
                elif select_elt.value=="剪取工具":
                        input_elt=INPUT(value="%windir%\system32\SnippingTool.exe",disabled=True,type="text",size="30")
                elif select_elt.value=="命令提示字元":
                        input_elt=INPUT(value="%windir%\system32\cmd.exe",disabled=True,type="text",size="30")
                div_elt<=input_elt
            div_elt<=select_elt.bind("change",change_input)
            div_elt<=INPUT(type="text",size="30")
        elif func_name=="終止程序":
            div_elt<=SPAN("程序名稱: ")+INPUT(type="text",size="30")
        elif func_name=="清空資源回收桶":
            pass
        elif func_name=="插入文字":
            div_elt<=SPAN("文字: ")+INPUT(type="text",size="30")+BR()
            form_elt=FORM()
            form_elt<=A_INPUTRadio("使用剪貼簿　",checked=True,name="insert_string_method",value="AutoInput")
            form_elt<=A_INPUTRadio("使用SendInput　",name="insert_string_method",value="SendInput")
            form_elt<=A_INPUTRadio("使用SendRaw　",name="insert_string_method",value="SendRaw")
            form_elt<=A_INPUTRadio("使用Send",name="insert_string_method",value="Send")
            div_elt<=form_elt
        elif func_name=="熱字串(自動展開縮寫)":
            #定義動作:滑鼠點擊文字框後將所有預設文字(placeholder)消除
            def ClearPlaceholder(ev):
                for input_elt in ev.currentTarget.parent.select("input[type='text']"):
                    input_elt.placeholder=""
            div_elt<=SPAN("輸入縮寫: ")+INPUT(type="text",size="10",placeholder="btw").bind("focusin",ClearPlaceholder)+BR()
            div_elt<=SPAN("展開文字: ")+INPUT(type="text",size="30",placeholder="By the way").bind("focusin",ClearPlaceholder)+BR()
            #設置勾選元素並設定attr_dict:打勾選項會在ahk熱字串設定符號加入symbol，否則加入nosymbol
            div_elt<=A_INPUTCheckbox("按下終止鍵後展開(如空格、Enter、Tab...)",checked=True,attr_dict={"symbol":"","nosymbol":"*"})+BR()
            div_elt<=A_INPUTCheckbox("展開後不觸發終止鍵　",checked=True,attr_dict={"symbol":"o","nosymbol":""})
            div_elt<=A_INPUTCheckbox("縮寫區分大小寫　",checked=True,attr_dict={"symbol":"c","nosymbol":""})
            div_elt<=A_INPUTCheckbox("可在字詞間展開　",checked=True,attr_dict={"symbol":"?","nosymbol":""})+BR()
        elif func_name=="執行cmd命令":
            div_elt<=SPAN("指令碼: ")
            div_elt<=INPUT(type="text",size="30")+BR()
            div_elt<=A_INPUTCheckbox("執行完關閉視窗")
        elif func_name=="鎖定/登出/休眠/關機":###
            form_elt=FORM(style={"margin-top":"8px"})
            form_elt<=A_INPUTRadio("鎖定　",checked=True,name="system_action",value="lock")
            form_elt<=A_INPUTRadio("登出　",name="system_action",value="logout")
            form_elt<=A_INPUTRadio("睡眠　",name="system_action",value="sleep")
            form_elt<=A_INPUTRadio("休眠　",name="system_action",value="hibernate")
            form_elt<=A_INPUTRadio("關機　",name="system_action",value="shutdown")
            form_elt<=A_INPUTRadio("重新啟動　",name="system_action",value="reboot")
            div_elt<=form_elt
        #特別處理:如果功能是熱字串，則關閉設定組合建功能，文字變灰
        div_input_key_area=doc["div_input_key_area"]
        inputAndSelect_elt_in_input_key_area_list=div_input_key_area.select("input")+div_input_key_area.select("select")
        span_elt_in_input_key_area_list=div_input_key_area.select("span")
        if func_name=="熱字串(自動展開縮寫)":
            for elt in inputAndSelect_elt_in_input_key_area_list:
                elt.disabled=True
            for elt in span_elt_in_input_key_area_list:
                elt.style.color="#ddd"
        else:
            for elt in inputAndSelect_elt_in_input_key_area_list:
                elt.disabled=False
            for elt in span_elt_in_input_key_area_list:
                elt.style.color=""

        return div_elt
    #定義動作:選擇功能選項時改變功能子選項(檔案路徑等)區塊
    def change_div_func_conent(ev):
        div_func_conent=ev.currentTarget.nextSibling
        div_func=ev.currentTarget.parent
        div_func_conent.remove()
        div_func<=DIV_func_conent(ev.currentTarget.value)

    ##1#設置功能選單
    select_function=SELECT(id="SELECT_function").bind('change',change_div_func_conent)
    select_function<=OPTION("開啟檔案")
    select_function<=OPTION("開啟資料夾")
    select_function<=OPTION("開啟網頁")
    select_function<=OPTION("搜尋選取的關鍵字")
    select_function<=OPTION("執行程式")
    select_function<=OPTION("終止程序")
    select_function<=OPTION("插入文字")
    select_function<=OPTION("熱字串(自動展開縮寫)")
    select_function<=OPTION("清空資源回收桶")
    select_function<=OPTION("執行cmd命令")
    select_function<=OPTION("鎖定/登出/休眠/關機")
    #排版
    div_elt<=select_function
    div_func_conent=DIV_func_conent("開啟檔案") #功能子選項(檔案路徑等)，預設為開啟檔案路徑
    div_elt<=div_func_conent
    return div_elt
#設定DIV設定組合鍵功能區塊樣式
AppStyle("""
    input[type="text"]{
        margin:10px 3px 3px 3px;
    }
""")

#**定義定期刷新顯示AHK語法動作**
def render_ahk_script():
    #獲取所有inputCheckbox組合鍵元素列表
    inputCheckbox_func_key_elt_list=doc.select("#div_input_key_area input[type='checkbox']")
    #牽涉執行函式列表
    ahk_related_function_list=[]
    #若都無勾選，就顯示提示文字(選擇熱字串功能時除外)
    if (doc["SELECT_function"].value!="熱字串(自動展開縮寫)") and all(checkbox.checked==False for checkbox in inputCheckbox_func_key_elt_list):
        ahk_script="請勾選熱鍵組合"
    else:
        #設置有勾選的組合建符號(例如^+C::)
        "加入功能鍵符號"
        ahk_key_script="".join(checkbox.symbol if checkbox.checked else "" for checkbox in inputCheckbox_func_key_elt_list)
        "加入鍵盤符號"
        ahk_key_script+=doc.select("select.normal_key")[0].value
        "加入執行冒號"
        ahk_key_script+=":: "
        "加入執行語法(未定義)"
        ahk_exec_script=None
        
        #獲取DIV組合鍵功能區塊
        div_function_elt=doc.select('#DIV_function')[0]
        if div_function_elt: #等待加載完畢
           #獲取SELECT組合鍵功能元素
            select_elt=div_function_elt.select("select")[0]
            #獲取DIV組合鍵子功能設定區塊
            div_func_conent_elt=div_function_elt.select("#DIV_func_conent")[0]

            ##3#根據選的組合鍵功能設置AHK語法(輸出:ahk_exec_script,ahk_related_function_list*) #星號為可選
            if select_elt.value in ["開啟資料夾","開啟網頁","執行程式"]:
                input_text=div_func_conent_elt.select("input")[0].value
                ahk_exec_script=f'Run "{input_text}"'
            elif select_elt.value=="開啟檔案":
                filePath=div_func_conent_elt.select("input[type='text']")[0].value
                programPath=div_func_conent_elt.select("input[type='text']")[1].value
                checkbox_elt=div_func_conent_elt.select('input[type="checkbox"]')[0]
                ahk_exec_script='Run'+(f' "{programPath}"' if checkbox_elt.checked else "")+f' "{filePath}"'
            elif select_elt.value=="搜尋選取的關鍵字":
                input_text_elts=div_func_conent_elt.select("input")
                input_elt_A_url,input_elt_B_url=[input_text_elt.value for input_text_elt in input_text_elts]
                ahk_exec_script=f'WebSite_Clipboard("{input_elt_A_url}","{input_elt_B_url}")'
                ahk_related_function_list=["WebSite_Clipboard","UriEncode"]
            elif select_elt.value=="終止程序":
                input_text=div_func_conent_elt.select("input")[0].value
                ahk_exec_script=f'Process, Close, "{input_text}"'
            elif select_elt.value=="清空資源回收桶":
                ahk_exec_script="FileRecycleEmpty"
            elif select_elt.value=="熱字串(自動展開縮寫)":
                abbreviation_input_elt=div_func_conent_elt.select("input[type='text']")[0]
                abbreviation_text=abbreviation_input_elt.value if abbreviation_input_elt.value else abbreviation_input_elt.placeholder
                inputCheckbox_elt_list=doc["DIV_func_conent"].select("input[type=checkbox]")
                #覆蓋ahk語法按鍵字串(如*oc等等符號)
                ahk_key_script=":"
                ahk_key_script+="".join([(inputCheckbox_elt.symbol if inputCheckbox_elt.checked else inputCheckbox_elt.nosymbol) for inputCheckbox_elt in inputCheckbox_elt_list ])
                ahk_key_script+=f":{abbreviation_text}::"
                extendedString_input_text_elt=div_func_conent_elt.select("input[type='text']")[1]
                ahk_exec_script=extendedString_input_text_elt.value if extendedString_input_text_elt.value else extendedString_input_text_elt.placeholder
            elif select_elt.value=="插入文字":
                insert_method=doc["DIV_func_conent"].select("input[type='radio']:checked")[0].value
                input_text=div_func_conent_elt.select("input[type='text']")[0].value
                #若選擇使用剪貼簿
                if insert_method=="AutoInput":
                    ahk_related_function_list=["AutoInput"]
                    ahk_exec_script='AutoInput("{}")'.format(input_text)
                else:
                    ahk_exec_script=insert_method+" "+input_text
            elif select_elt.value=="執行cmd命令":
                ahk_exec_script="Run %comspec%"
                input_text_elt=div_func_conent_elt.select("input[type=text]")[0]
                input_checkbox_elt=div_func_conent_elt.select("input[type=checkbox]")[0]
                ahk_exec_script+=" /c " if input_checkbox_elt.checked else " /k "
                ahk_exec_script+=input_text_elt.value
            elif select_elt.value=="鎖定/登出/休眠/關機":###
                system_action=doc["DIV_func_conent"].select("input[type='radio']:checked")[0].value
                if system_action=="lock":
                    ahk_exec_script="\nRun rundll32.exe user32.dll`,LockWorkStation\nReturn"
                else:
                    ahk_exec_script=""
            else:
                ahk_exec_script="(錯誤)"
                

        #產生AHK語法:合併組合鍵符號和執行語法
        ahk_script=ahk_key_script+ahk_exec_script


    #更新DIV顯示對應AHK語法區塊文字
    div_ahk_srcipt_output=doc.select("#ahk_srcipt_output")
    #若該區塊已經被BRYTHON生成，才執行更新動作
    if div_ahk_srcipt_output:
        #顯示AHK語法
        div_ahk_srcipt_output[0].text=ahk_script
    #若語法有涉及函數
    if ahk_related_function_list:
        #顯示關聯函式內容語法
        ahk_function_srcipt_output_text=""
        for function_name in ahk_related_function_list:
            ahk_function_srcipt_output_text+=FUNCTION_DICT[function_name]
        
        #開啟函式頁籤
        doc["function_div_page_tag"].classList.remove("div_page_tag_none")
    #若語法沒有涉及函數
    else:
        #顯示關聯函式內容為"(無)"
        ahk_function_srcipt_output_text="(無)"
        #停用函式頁籤
        doc["function_div_page_tag"].classList.add("div_page_tag_none")
        #強制切換至[AHK語法]標籤
        doc["ahk_script_div_page_tag"].click()
        
    #顯示關聯函式內容
    doc["ahk_function_srcipt_output"].text=ahk_function_srcipt_output_text
    
    

AppStyle("""
    .div_page_tag_none{
        color: #666;
        text-shadow: #eee 1px 2px;
        cursor:default !important;
        pointer-events:none !important;
    }
""")

#定義DIV顯示對應AHK語法區塊
def DIV_ahkSciptBlock():
    div_elt=DIV(Class="div_ahk_srcipt")
    div_container=DIV(Class="ahk_block_container")
    div_elt<=div_container
    div_container<=DIV("請勾選熱鍵組合",id="ahk_srcipt_output")
    div_container<=PRE("(無)"
                         ,id="ahk_function_srcipt_output"
                         ,style={"display":"none"})
    return div_elt
#定義DIV顯示對應AHK函數語法區塊
def DIV_ahkFunctionScipt():
    div_elt=DIV(Class="div_ahk_srcipt")
    div_container=DIV(Class="ahk_block_container")
    #div_elt<=div_container
    div_elt<=TEXTAREA("(無)"
                         ,id="ahk_function_srcipt_output"
                         ,style={"display":"none"})
    return div_elt

#設定DIV顯示對應AHK語法區塊樣式
AppStyle("""
    .ahk_block_container{
        padding:10px;
        overflow-x:scroll;
    }
    div#ahk_srcipt_output , textarea#ahk_function_srcipt_output{
        width:100%;
        background-color:"""+ACTIVE_SCRIPT_TAG_COLOR+""";
    }
    div#ahk_srcipt_output{
        white-space: nowrap;
    }
    textarea#ahk_function_srcipt_output{
        border:0;
    }
""")



#定義DIV語法顯示區域切換標籤區塊
def DIV_SciptTabs():

    #定義切換頁籤動作
    def SwitchScriptPage(ev):
        #獲取跳轉物件
        div_sciptTabs=ev.currentTarget.parent
        div_tag_current=div_sciptTabs.select("div.tag_active")[0]
        div_tag_jumpTo=ev.currentTarget
        #若符合跳轉條件
        if div_tag_current != div_tag_jumpTo:
            #切換AHK標籤的樣式:透過增減ClassName

            #跳離目前tab和AHK語法區塊
            div_tag_current.classList.remove("tag_active")
            div_tag_current.classList.add("tag_unactive")
            doc[div_tag_current.correspond_div_page_id].style.display="none"

            #跳至點遠tab和AHK語法區塊
            div_tag_jumpTo.classList.remove("tag_unactive")
            div_tag_jumpTo.classList.add("tag_active")
            doc[div_tag_jumpTo.correspond_div_page_id].style.display="block"

    div_elt=DIV()
    #定義DIV標籤，預設為非激活狀態
    def DIV_Tab(string,Class="tag_unactive",correspond_div_page_id="",id=None):
        style={"width":"auto","float":"left","padding":"8px","cursor":"pointer","border-raius":""}
        if id:
            div_elt=DIV(string,Class=Class,style=style,id=id)
        else:
            div_elt=DIV(string,Class=Class,style=style)
        div_elt.bind("click",SwitchScriptPage)
        div_elt.classList.add("ahk_script_tag")
        div_elt.correspond_div_page_id=correspond_div_page_id
        return div_elt

    div_elt<=DIV_Tab("AHK語法",id="ahk_script_div_page_tag",Class="tag_active",correspond_div_page_id="ahk_srcipt_output")
    div_elt<=DIV_Tab("函式",id="function_div_page_tag",correspond_div_page_id="ahk_function_srcipt_output")
    return div_elt
#設定啟用和非啟用標籤顏色
AppStyle("""
    div.div_ahk_srcipt{
        background-color:"""+ACTIVE_SCRIPT_TAG_COLOR+""";
        width:100%;
    }
    div.ahk_script_tag{
        padding:10px 5px;
        white-space:nowrap;
        background-color:"""+ACTIVE_SCRIPT_TAG_COLOR+""";
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
    }
    div.tag_active{
        background-color:"""+ACTIVE_SCRIPT_TAG_COLOR+""";
    }
    div.tag_unactive{
        background-color:"""+UNACTIVE_SCRIPT_TAG_COLOR+""";
    }
""")


#進行排版
div_main=DIV(Class="main")
doc<=div_main

#主區塊樣式
AppStyle("""
    div.main{
        width:100%;
        max-width:600px;
    }
""")

div_setting_hotkey=DIV(Class="page_border")
div_setting_hotkey<=P("設定組合鍵:")+DIV_input_key_area()
div_main<=div_setting_hotkey

div_setting_function=DIV(Class="page_border")
div_setting_function<=P("設定功能:")+DIV_function()+BR()
div_main<=div_setting_function

#淺藍區塊樣式
AppStyle("""
    div.page_border{
        background-color: #9cedf1;
    	padding: 1px 20px 20px 20px;
        margin: 0 0 10px 0px;
        border-radius: 10px;
    }
""")

def doCopy(ev):
    string=doc["ahk_srcipt_output"].text
    ahk_function_srcipt_output_text=doc["ahk_function_srcipt_output"].text
    if ahk_function_srcipt_output_text!="(無)":
        string+="\n\n;===相關函數===\n\n"
        string+=doc["ahk_function_srcipt_output"].text
    CopyTextToClipborad(string)


#排版
div_main<=H1("AutoHotKey 自動化工具語法產生器 v0.1",style={"color":"#3939dc","font-size":"18px"})

div_main<=div_setting_hotkey
div_main<=div_setting_function

div_main<=DIV_SciptTabs()
div_main<=DIV(style={"clear":"both"})
div_main<=DIV(DIV_ahkSciptBlock())
div_main<=BUTTON("複製").bind("click",doCopy)

#刷新語法
render_ahk_script() #載入時刷新語法
timer.set_interval(render_ahk_script,1000) #設定每秒刷新AHK語法
#doc<=BUTTON("CHECK").bind("click",render_ahk_script)

</script>




</body>
</html>
